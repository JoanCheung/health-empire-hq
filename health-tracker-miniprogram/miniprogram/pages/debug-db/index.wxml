<view class="container">
  <view class="header">
    <view class="title">ğŸ” æ•°æ®åº“è°ƒè¯•</view>
    <view class="subtitle">æ£€æŸ¥å¥åº·è®°å½•æ•°æ®ä¿å­˜æƒ…å†µ</view>
  </view>

  <view wx:if="{{loading}}" class="loading-section">
    <view class="loading-icon">â³</view>
    <text>åŠ è½½æ•°æ®åº“ä¿¡æ¯ä¸­...</text>
  </view>

  <view wx:else>
    <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
    <view class="stats-section">
      <view class="section-title">ğŸ“Š æ•°æ®ç»Ÿè®¡</view>
      <view class="stats-grid">
        <view class="stat-item">
          <view class="stat-label">æ€»è®°å½•æ•°</view>
          <view class="stat-value">{{stats.totalRecords}}</view>
        </view>
        <view class="stat-item">
          <view class="stat-label">è®°å½•æ—¥æœŸæ•°</view>
          <view class="stat-value">{{stats.dates.length}}</view>
        </view>
        <view class="stat-item">
          <view class="stat-label">æœ€æ–°è®°å½•</view>
          <view class="stat-value">{{stats.latestRecord.date}}</view>
        </view>
        <view class="stat-item">
          <view class="stat-label">æœ€æ—§è®°å½•</view>
          <view class="stat-value">{{stats.oldestRecord.date}}</view>
        </view>
      </view>
    </view>

    <!-- APIä½¿ç”¨ç»Ÿè®¡ -->
    <view class="api-stats-section" wx:if="{{stats.apiSources}}">
      <view class="section-title">ğŸ¤– APIä½¿ç”¨ç»Ÿè®¡</view>
      <view class="api-list">
        <view class="api-item" wx:for="{{stats.apiSources}}" wx:for-item="count" wx:for-index="api" wx:key="api">
          <view class="api-name">{{api}}</view>
          <view class="api-count">{{count}}æ¬¡</view>
        </view>
      </view>
    </view>

    <!-- æ—¥æœŸåˆ—è¡¨ -->
    <view class="dates-section" wx:if="{{stats.dates.length > 0}}">
      <view class="section-title">ğŸ“… è®°å½•æ—¥æœŸ</view>
      <view class="dates-list">
        <view class="date-item" wx:for="{{stats.dates}}" wx:key="*this">
          {{item}}
        </view>
      </view>
    </view>

    <!-- è¯¦ç»†è®°å½• -->
    <view class="records-section" wx:if="{{records.length > 0}}">
      <view class="section-title">ğŸ“‹ è¯¦ç»†è®°å½•</view>
      <view class="records-list">
        <view class="record-item" wx:for="{{records}}" wx:key="_id">
          <view class="record-header">
            <view class="record-date">{{item.date}}</view>
            <view class="record-time">{{item.time}}</view>
          </view>
          <view class="record-details">
            <view class="detail-item">
              <text class="detail-label">å¥åº·è¯„åˆ†:</text>
              <text class="detail-value">{{item.healthScore}}</text>
            </view>
            <view class="detail-item">
              <text class="detail-label">APIæ¥æº:</text>
              <text class="detail-value">{{item.analysis.apiSource || 'unknown'}}</text>
            </view>
            <view class="detail-item">
              <text class="detail-label">è®°å½•ID:</text>
              <text class="detail-value">{{item._id}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- æ— æ•°æ®æç¤º -->
    <view wx:if="{{records.length === 0}}" class="no-data">
      <view class="no-data-icon">ğŸ“­</view>
      <view class="no-data-text">æ•°æ®åº“ä¸­æ²¡æœ‰æ‰¾åˆ°å¥åº·è®°å½•</view>
    </view>

    <!-- æ“ä½œæŒ‰é’® -->
    <view class="actions">
      <button class="action-btn primary" bindtap="testSaveRecord">ğŸ§ª æµ‹è¯•ä¿å­˜è®°å½•</button>
      <button class="action-btn secondary" bindtap="refreshData">ğŸ”„ åˆ·æ–°æ•°æ®</button>
      <button class="action-btn tertiary" bindtap="goBack">â†©ï¸ è¿”å›</button>
    </view>
  </view>
</view>